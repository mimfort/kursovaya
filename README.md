# Курсовая: Telegram-бот для генерации и проверки задач

## Быстрый старт
- Создайте `.env` с токеном бота:
  ```
  BOT_TOKEN=ваш_токен_бота
  DATABASE_URL=sqlite+aiosqlite:///./bot.db  # опционально
  ```
- Установите зависимости: `pip install -e .` или `pip install aiogram SQLAlchemy sympy reportlab python-dotenv qrcode[pil] pytest`.
- Запустите: `python main.py`.

## Что внутри
- `aiogram` — диалог и FSM, inline/клавиатуры.
- `SQLAlchemy` + `SQLite` — пользователи, наборы задач, попытки, статистика.
- `SymPy` — нормализация и сравнение ответов.
- `ReportLab` — сборка PDF с вариантами.
- `qrcode` — QR на бота в PDF.
- Модули:
  - `core/` — конфиг, логирование.
  - `db/` — модели, создание сессии, репозиторий.
  - `tasks/` — генерация задач и проверка ответов.
  - `pdf/` — генерация PDF.
  - `bot/handlers/` — регистрации, создание варианта, проверка, статистика.
  - `tests/` — базовые проверки генератора и чекера.

## Сценарии
- `/start` → регистрация (ФИО, класс) → главное меню.
- «Новый вариант» → выбор предмета → сложность → количество задач → PDF + переход к проверке.
- «Проверить ответы» или «Продолжить вариант» → ввод ответов по порядку → «верно/неверно» + кнопки повтор/показ ответа (фиксируется подсмотр).
- «Статистика» → суммарные, по предметам/темам, за 7 дней, сколько раз подсмотрено.
- `/help` — краткая памятка и примеры ответов.

## Важные моменты
- Ответы генерируются так, чтобы быть конечными десятичными дробями или целыми (округление до тысячных).
- При проверке принимаются только десятичные дроби или целые (`0.5`, `0,5`), без обыкновенных дробей, погрешность `1e-6`.
- PDF сохраняются в `./generated_pdfs` (можно поменять `PDF_DIR` в `.env`).
